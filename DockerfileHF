FROM python:3.11-slim

# Evita output bufferato
ENV PYTHONUNBUFFERED=1

# Crea cartella di lavoro
WORKDIR /app

# Installa wget e pip
RUN apt-get update && apt-get install -y wget && rm -rf /var/lib/apt/lists/*

# Scarica i file dal tuo repository GitHub (modifica gli URL con quelli veri!)
RUN wget -O app.py https://raw.githubusercontent.com/nzo66/tvproxy/main/app.py && \
    wget -O requirements.txt https://raw.githubusercontent.com/nzo66/tvproxy/main/requirements.txt

# Installa le dipendenze
RUN pip install --no-cache-dir --upgrade pip && \
    pip install --no-cache-dir -r requirements.txt

# Hugging Face Spaces richiede porta 7860
EXPOSE 7860

# Avvia il server FastAPI
CMD ["uvicorn", "app:app", "--host", "0.0.0.0", "--port", "7860"]